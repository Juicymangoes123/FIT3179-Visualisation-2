{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "title": "Net overseas migration into each state over time",
    "params": [
        {
            "name": "state_selection",
            "value": "Victoria",
            "bind": {
                "input": "select",
                "name": "State: ",
                "options": [
                    "Victoria",
                    "New South Wales",
                    "Western Australia",
                    "South Australia",
                    "Northern Territory",
                    "Queensland",
                    "Australian Capital Territory",
                    "Tasmania"
                ]
            }
        }
    ],
    "hconcat": [
        {
            "width": 500,
            "height": 400,
            "data": {
                "url": "overseas_migration.csv"
            },
            "transform": [
                {
                    "filter": "!state_selection || datum.State == state_selection"
                }
            ],
            "layer": [
                {
                    "mark": {
                        "type": "rect",
                        "color": "lightblue"
                    },
                    "encoding": {
                        "x": {
                            "value": 420 
                        },
                        "x2": {
                            "value": 475
                        },
                        "y": {
                            "value": 0
                        }
                    }
                },
                {
                    "mark": {
                        "type": "text",
                        "color": "black"
                    },
                    "encoding": {
                        "text": {
                            "value": "COVID-19"
                        },
                        "x": {
                            "value": 446
                        },
                        "y": {
                            "value": 10
                        }
                    }
                },
                {
                    "mark": {
                        "type": "rect",
                        "color": "lightblue"
                    },
                    "encoding": {
                        "x": {
                            "value": 10 
                        },
                        "x2": {
                            "value": 120
                        },
                        "y": {
                            "value": 0
                        }
                    }
                },
                {
                    "mark": {
                        "type": "text",
                        "color": "black"
                    },
                    "encoding": {
                        "text": {
                            "value": ["Rapid economic", "expansion", "demanded skilled", "labour"]
                        },
                        "x": {
                            "value": 60
                        },
                        "y": {
                            "value": 10
                        }
                    }
                },
                {
                    "mark": {
                        "type": "rect",
                        "color": "lightgray"
                    },
                    "encoding": {
                        "x": {
                            "value": 120 
                        },
                        "x2": {
                            "value": 170
                        },
                        "y": {
                            "value": 0
                        }
                    }
                },
                {
                    "mark": {
                        "type": "text",
                        "color": "black"
                    },
                    "encoding": {
                        "text": {
                            "value": ["Global", "Financial", "Crisis"]
                        },
                        "x": {
                            "value": 145
                        },
                        "y": {
                            "value": 10
                        }
                    }
                },
                {
                    "mark": {
                        "type": "line",
                        "strokeWidth": 2
                    },
                    "encoding": {
                        "x": {
                            "field": "year",
                            "type": "ordinal",
                            "title": ""
                        },
                        "y": {
                            "field": "net_overseas_migration",
                            "type": "quantitative",
                            "title": "Total"
                        }
                    }
                },
                {
                    "mark": {
                        "type": "point",
                        "size": 25,
                        "color": "green"
                    },
                    "encoding": {
                        "x": {
                            "field": "year",
                            "type": "ordinal",
                            "title": ""
                        },
                        "y": {
                            "field": "net_overseas_migration",
                            "type": "quantitative",
                            "title": "Total"
                        },
                        "tooltip": [
                            {
                                "field": "year",
                                "type": "ordinal",
                                "title": "Year"
                            },
                            {
                                "field": "net_overseas_migration",
                                "type": "quantitative",
                                "title": "Net overseas migration",
                                "format": ","
                            }
                        ]
                    }
                }
            ]
        },
        {
            "width": 500,
            "height": 400,
            "title": "Reasons for migration into Australia",
            "data": {
                "url": "migration_reason.csv"
            },
            "params": [
                {
                    "name": "state_selection",
                    "value": "Victoria",
                    "bind": {
                        "input": "select",
                        "name": "State",
                        "options": [
                            "Victoria",
                            "New South Wales",
                            "Western Australia",
                            "South Australia",
                            "Northern Territory",
                            "Queensland",
                            "Australian Capital Territory",
                            "Tasmania"
                        ]
                    }
                }
            ],
            "layer": [
                {
                    "mark": "bar",
                    "transform": [
                        {
                            "filter": "!state_selection || datum.State==state_selection"
                        },
                        {
                            "filter": {
                                "field": "reason",
                                "oneOf": [
                                    "family",
                                    "skilled-permanent",
                                    "special-eligibility-humanitarian",
                                    "other"
                                ]
                            }
                        }
                    ],
                    "encoding": {
                        "x": {
                            "field": "year",
                            "timeunit": "year",
                            "type": "ordinal",
                            "axis": {
                                "title": "Year"
                            }
                        },
                        "y": {
                            "field": "amount",
                            "type": "quantitative",
                            "title": "",
                            "sort": "reason"
                        },
                        "color": {
                            "field": "reason",
                            "type": "nominal",
                            "legend": {
                                "title": "Reason for arriving in Australia"
                            }
                        },
                        "tooltip": [
                            {
                                "field": "year",
                                "type": "ordinal",
                                "title": "Year"
                            },
                            {
                                "field": "State",
                                "type": "nominal",
                                "title": "State"
                            },
                            {
                                "field": "reason",
                                "type": "nominal",
                                "title": "Reason"
                            },
                            {
                                "field": "amount",
                                "type": "quantitative",
                                "title": "Number",
                                "format": ","
                            }
                        ]
                    }
                }
            ]
        }
    ],
    "spacing": 390
}